#!/bin/sh
################################################################################
## Home session initialization.
## 2012-09-09
################################################################################

## Fetch source from Git repo:
# cd
# git init
# git remote add origin https://github.com/Ambrevar/home-config.git
# git fetch
# git branch master origin/master
# git checkout master

################################################################################
## The following is used as first-run setup.

SOURCEDIR="${HOME}/personal/dataperso"

## Mutt
echo "==> Mutt"
ln -sf "$(realpath ${SOURCEDIR}/MAILS)" "${HOME}/.mutt"
mkdir -p "${HOME}/.mutt.d/hcache"
echo

## Taskwarrior
echo "==> Taskwarrior"
ln -sf "${SOURCEDIR}/TODO" "${HOME}/.task"
echo

## Awesome
echo "==> Awesome"
THEME_DEST="${HOME}/.config/awesome/themes/custom"
THEME_SOURCE="/usr/share/awesome/themes/default/"
if [ ! -e "${THEME_DEST}/background.png" ]; then
    [ -d "${THEME_SOURCE}" ] && cp -rn ${THEME_SOURCE}/* "${THEME_DEST}"
fi
echo

## rtorrent
echo "==> rtorrent"
mkdir -p "${HOME}/.session"
echo

## Luakit -- Fetch Adblock list.
## This is handy to update lists regularly.
echo "==> Luakit"

# Update the adblock modules
git clone https://github.com/Plaque-fcc/luakit-adblock/ "${HOME}/luakit-adblock"
cp -fv ~/luakit-adblock/*.lua "$XDG_CONFIG_HOME/luakit"
rm -rvf "$HOME/luakit-adblock"

# Update the adblock lists
mkdir -p "$XDG_DATA_HOME/luakit/adblock"
wget https://easylist-downloads.adblockplus.org/easylist.txt \
     https://easylist-downloads.adblockplus.org/easyprivacy.txt \
     https://easylist-downloads.adblockplus.org/easylistgermany.txt \
     http://lian.info.tm/liste_fr.txt \
    -P "$XDG_DATA_HOME/luakit/adblock"
# https://adblock-chinalist.googlecode.com/svn/trunk/adblock.txt # ChinaList
# https://easylist-downloads.adblockplus.org/easylistitaly.txt
# https://dutchadblockfilters.googlecode.com/svn/trunk/AdBlock_Dutch_hide.txt
# http://stanev.org/abp/adblock_bg.txt # Bulgarian List
# https://indonesianadblockrules.googlecode.com/hg/subscriptions/abpindo.txt # AB Pindo (Indonesian)

## Bookmarks
ln -sf "${SOURCEDIR}/BOOKMARKS/bookmarks.db" "$XDG_DATA_HOME/luakit/bookmarks.db"
ln -sf "${SOURCEDIR}/BOOKMARKS/quickmarks" "$XDG_DATA_HOME/luakit/quickmarks"

echo
